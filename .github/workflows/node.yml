name: NodeJS

on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]
    
env:
  GITHUB_TOKEN: ${{secrets.TEST_USER_TOKEN}}
  
jobs:
  build:

    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v2
    - name: Setup virtual display
      run: |
         sudo apt-get install xvfb
         wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb
         sudo dpkg -i google-chrome*.deb
         sudo apt-get install -f
         sudo apt autoremove
         rm -rf *.deb
    - name: Restore dependencies
      run: |
        cd 2021/typescript
        npm ci
    - name: Run Tests
      run: |
        cd 2021/typescript
        xvfb-run --auto-servernum npm run test
